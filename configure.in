dnl
dnl This is the configuration file for GNU oleo.
dnl $Id: configure.in,v 1.21 1998/08/19 07:44:52 danny Exp $
dnl
dnl Process this file with autoconf to produce a configure script.
dnl
AC_INIT(src/init.c)

AM_INIT_AUTOMAKE([oleo], [1.6.6])
GNU_PACKAGE="GNU $PACKAGE"
AC_DEFINE_UNQUOTED(GNU_PACKAGE, "$GNU_PACKAGE")

dnl Define available languages
ALL_LINGUAS=""

AC_ARG_PROGRAM
AM_CONFIG_HEADER(config.h)

dnl Detect Cygwin32 environment
AM_CYGWIN32

dnl Checks for programs.
AC_PROG_YACC
AC_PROG_CC
AM_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_RANLIB

dnl Checks the Compiler.
AM_C_PROTOTYPES

dnl Checks for libraries.
dnl Replace `main' with a function in -lncurses:
AC_CHECK_LIB(ncurses, main, ,
	AC_CHECK_LIB(curses, main, ,
		AC_CHECK_LIB(termlib, tgetent, ,
			AC_CHECK_LIB(termcap, tgetend))))

dnl This library is required on FreeBSD.
AC_CHECK_LIB(mytinfo, tputs)

dnl Replace `main' with a function in -lm:
AC_CHECK_LIB(m, main)

dnl Checks for X11
AC_PATH_XTRA
AC_FIND_MOTIF
ICE_FIND_Xbae
ICE_FIND_XmHTML
ICE_FIND_SciPlot

CFLAGS="$CFLAGS $X_CFLAGS"
LIBS="$LIBS $X_LIBS"

dnl Checks for X11 Libraries
AC_CHECK_LIB(X11, main)

dnl Checks for Guile
AC_CHECK_LIB(guile, scm_boot_guile)

dnl Checks if -DDEBUG is requested
AC_ARG_WITH(debug,
[  --with-debug                   Send debugging info to stderr],
[              case "${withval}" in
                 y | ye | yes )         usedebug=yes ;;
                 n | no )               usedebug=no ;;
                 * )                    usedebug=yes ;;
               esac],
[              with_debug=no])

if test $with_debug = yes; then
  CFLAGS="$CFLAGS -DDEBUG"
  if test "x$GCC" = "xyes"; then
    if test -z "`echo "$CFLAGS" | grep "\-Wall" 2> /dev/null`"; then
      CFLAGS="$CFLAGS -Wall"
    fi
  fi
fi
           
dnl Checks for GTK
AC_ARG_WITH(gtk,
[  --without-gtk		  Do not use GTK, even if detected],
[		case "${withval}" in
		  y | ye | yes )	usegtk=yes ;;
		  n | no )		usegtk=no ;;
		  * )			usegtk=yes ;;
		esac],
[		with_gtk=yes])
dnl
dnl remaining GTK check moved after Motif stuff
dnl

dnl dnl
dnl dnl Motif (LessTif)
dnl dnl
dnl dnl If user selects Motif, deselect GTK even if the user requested it.
dnl dnl
dnl AC_ARG_WITH(motif,
dnl [  --without-motif		  Do not use Motif, even if detected],
dnl [		case "${withval}" in
dnl 		  y | ye | yes )	usemotif=yes ;;
dnl 		  n | no )		usemotif=no ;;
dnl 		  * )			usemotif=yes ;;
dnl 		esac],
dnl [		with_motif=yes])
dnl 
dnl if test $with_motif = yes; then
dnl 	usegtk=no
dnl fi
dnl dnl AC_FIND_MOTIF

if test $with_gtk = yes; then
AM_PATH_GTK(1.0.0, AC_DEFINE(HAVE_LIBGTK))
fi

dnl Checks for header files.
AC_HEADER_DIRENT
AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h limits.h malloc.h strings.h sys/time.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_C_INLINE
AC_TYPE_SIZE_T
AC_HEADER_TIME
AC_STRUCT_TM
AC_STRUCT_TIMEZONE

dnl Checks for library functions.
AC_FUNC_ALLOCA
AC_TYPE_SIGNAL
AC_FUNC_STRFTIME
AC_FUNC_VPRINTF
AC_CHECK_FUNCS(ftime gethostname gettimeofday mktime select strdup strstr)
AM_FUNC_MKTIME
AM_FUNC_OBSTACK

dnl See if we're GNU Gettext friendly
AM_GNU_GETTEXT

AC_LINK_FILES($nls_cv_header_libgt, $nls_cv_header_intl)

AC_SUBST(LIBOBJS)

AC_SUBST(include_motif)
AC_SUBST(link_motif)
AC_SUBST(include_xbae)
AC_SUBST(link_xbae)
AC_SUBST(include_xmhtml)
AC_SUBST(link_xmhtml)
AC_SUBST(include_sciplot)
AC_SUBST(link_sciplot)

AC_OUTPUT([Makefile oleobug doc/Makefile lib/Makefile src/Makefile intl/Makefile m4/Makefile])

dnl AC_OUTPUT([Makefile oleobug doc/Makefile lib/Makefile src/Makefile intl/Makefile m4/Makefile po/Makefile.in], [sed -e "/POTFILES =/r po/POTFILES" po/Makefile.in > po/Makefile])
